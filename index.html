<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners -->
  <meta name="description" content="Anomagic: Crossmodal Prompt-driven Zero-shot Anomaly Generation">
  <meta property="og:title" content="Anomagic: Crossmodal Prompt-driven Zero-shot Anomaly Generation"/>
  <meta property="og:description" content="A zero-shot anomaly generation method using crossmodal prompts, accepted at AAAI 2026"/>
  <meta property="og:url" content="https://yuxin-jiang.github.io/Anomagic.github.io"/>
  <!-- Replace with your banner image -->
  <meta property="og:image" content="static/images/teaser_anomagic.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="Anomagic: Crossmodal Prompt-driven Zero-shot Anomaly Generation">
  <meta name="twitter:description" content="A zero-shot anomaly generation method using crossmodal prompts">
  <!-- Replace with your twitter banner image -->
  <meta name="twitter:image" content="static/images/teaser_anomagic.png">
  <meta name="twitter:card" content="summary_large_image">
  
  <meta name="keywords" content="Anomaly Detection, Zero-shot Generation, Crossmodal Learning, AAAI 2026">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Anomagic: Crossmodal Prompt-driven Zero-shot Anomaly Generation</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>

  <!-- News Section -->
  <section class="hero is-light">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column is-four-fifths">
            <div class="content has-text-left">
              <h2 class="title is-3">üåü News</h2>
              <p class="is-size-5">üöÄ <strong>Code updated with memory optimization!</strong> Now you can run the code on under <strong>30GB GPU memory</strong> without issues.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- Main Header Section -->
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">[AAAI 2026] Anomagic: Crossmodal Prompt-driven Zero-shot Anomaly Generation</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://github.com/yuxin-jiang" target="_blank">Yuxin Jiang</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="https://github.com/wei-luo-tsinghua" target="_blank">Wei Luo</a><sup>3</sup>,</span>
              <span class="author-block">
                <a href="https://github.com/hui-zhang-cas" target="_blank">Hui Zhang</a><sup>2</sup>,</span>
              <span class="author-block">
                <a href="https://github.com/qiyu-chen-ia" target="_blank">Qiyu Chen</a><sup>4</sup>,</span>
              <span class="author-block">
                <a href="https://github.com/haiming-yao-tsinghua" target="_blank">Haiming Yao</a><sup>3</sup>,</span>
              <span class="author-block">
                <a href="https://wshen.ieee.org/" target="_blank">Weiming Shen</a><sup>1,‚Ä†</sup>,</span>
              <span class="author-block">
                <a href="https://caoyunkang.github.io/" target="_blank">Yunkang Cao</a><sup>2,*</sup>
              </span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block"><sup>1</sup>Huazhong University of Science and Technology, <sup>2</sup>Hunan University, <sup>3</sup>Tsinghua University, <sup>4</sup>Institute of Automation, Chinese Academy of Sciences</span>
              <span class="eql-cntrb"><small><br><sup>‚Ä†</sup>Co-corresponding author &emsp;&emsp; <sup>*</sup>Corresponding author</small></span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- Project Page link -->
                <span class="link-block">
                  <a href="https://github.com/yuxin-jiang/Anomagic" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fas fa-home"></i>
                  </span>
                  <span>Project Page</span>
                </a>
              </span>

              <!-- Paper link -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2501.12345" target="_blank"
                class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                  <i class="fas fa-file-pdf"></i>
                </span>
                <span>Paper</span>
              </a>
            </span>

            <!-- Code link -->
            <span class="link-block">
              <a href="https://github.com/yuxin-jiang/Anomagic" target="_blank"
              class="external-link button is-normal is-rounded is-dark">
              <span class="icon">
                <i class="fab fa-github"></i>
              </span>
              <span>Code</span>
            </a>
          </span>

          <!-- HuggingFace Demo link -->
          <span class="link-block">
            <a href="https://huggingface.co/spaces/yuxin-jiang/Anomagic" target="_blank"
            class="external-link button is-normal is-rounded is-dark">
            <span class="icon">
              <i class="fab fa-hugging-face"></i>
            </span>
            <span>HuggingFace Demo (coming soon)</span>
          </a>
        </span>
      </div>
    </div>
  </div>
</div>
</section>


<!-- Teaser Image -->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="static/images/teaser_anomagic.png" alt="Anomagic Teaser" id="teaser" style="width: 100%; object-fit: cover;"/>
    </div>
  </div>
</section>


<!-- Abstract Section -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            We propose <strong>Anomagic</strong>, a zero-shot anomaly generation method that produces semantically coherent anomalies without requiring any exemplar anomalies. By unifying both visual and textual cues through a crossmodal prompt encoding scheme, Anomagic leverages rich contextual information to steer an inpainting‚Äêbased generation pipeline. A subsequent contrastive refinement strategy enforces precise alignment between synthesized anomalies and their masks, thereby bolstering downstream anomaly detection accuracy. 
          </p>
          <p>
            To facilitate training, we introduce AnomagicDataset, a collection of 12,987 anomaly‚Äìmask‚Äìcaption triplets assembled from 13 publicly available datasets, where captions are automatically generated by multimodal large language models using structured visual prompts and template‚Äêbased textual hints. Extensive experiments demonstrate that Anomagic trained on AnomagicDataset can synthesize more realistic and varied anomalies than prior methods, yielding superior improvements in downstream anomaly detection. Furthermore, Anomagic can generate anomalies for any normal‚Äêcategory image using user‚Äêdefined prompts, establishing a versatile foundation model for anomaly generation.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Inference Results (Carousel) -->
<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3 has-text-centered">Anomaly Inference Results</h2>
      <div id="results-carousel" class="carousel results-carousel">
        <!-- Industrial Datasets -->
        <div class="item">
          <div class="columns is-multiline">
            <div class="column is-full has-text-centered">
              <h3 class="subtitle is-4">Industrial Datasets (VisA & MVTecAD)</h3>
            </div>
            <div class="column is-half">
              <img src="static/images/visa_pcb_anomaly.png" alt="VisA PCB Anomaly" style="width: 100%;"/>
              <p class="has-text-centered">VisA: PCB with solder defect</p>
            </div>
            <div class="column is-half">
              <img src="static/images/mvtec_capsule_anomaly.png" alt="MVTec Capsule Anomaly" style="width: 100%;"/>
              <p class="has-text-centered">MVTecAD: Capsule with contamination</p>
            </div>
          </div>
        </div>

        <!-- Medical Imaging -->
        <div class="item">
          <div class="columns is-multiline">
            <div class="column is-full has-text-centered">
              <h3 class="subtitle is-4">Medical Imaging</h3>
            </div>
            <div class="column is-half">
              <img src="static/images/brats_tumor_anomaly.png" alt="BraTS Tumor Anomaly" style="width: 100%;"/>
              <p class="has-text-centered">BraTS: Brain MRI with enhanced tumor region</p>
            </div>
            <div class="column is-half">
              <img src="static/images/oct_retina_anomaly.png" alt="OCT Retina Anomaly" style="width: 100%;"/>
              <p class="has-text-centered">OCT: Retinal scan with macular edema</p>
            </div>
          </div>
        </div>

        <!-- Web-Crawled Objects -->
        <div class="item">
          <div class="columns is-multiline">
            <div class="column is-full has-text-centered">
              <h3 class="subtitle is-4">Web-Crawled Real-World Objects</h3>
            </div>
            <div class="column is-half">
              <img src="static/images/web_table_faded.png" alt="Table Fading Anomaly" style="width: 100%;"/>
              <p class="has-text-centered">Table surface with fading/discoloration</p>
            </div>
            <div class="column is-half">
              <img src="static/images/web_bottle_crack.png" alt="Bottle Crack Anomaly" style="width: 100%;"/>
              <p class="has-text-centered">Bottle with structural crack</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Requirements & Installation -->
<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">Requirements & Installation</h2>
    
    <div class="columns is-centered">
      <div class="column is-four-fifths">
        <h3 class="title is-4">üíª Requirements</h3>
        <ul class="content">
          <li>Python 3.8.20</li>
          <li>CUDA 11.6+</li>
        </ul>

        <h3 class="title is-4">üõ†Ô∏è Installation</h3>
        <div class="content">
          <p>Create and activate the environment:</p>
          <pre><code>conda env create -f env.yml
conda activate Anomagic  # Or the name specified in env.yml</code></pre>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Workflow Section -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">üöÄ Workflow</h2>
    <div class="columns is-centered">
      <div class="column is-four-fifths">
        <p class="content has-text-justified">Follow these steps to prepare data, train models, and generate synthetic anomaly images. The pipeline is designed for VisA and MVTec datasets.</p>
        
        <ol class="content has-text-justified" style="padding-left: 20px;">
          <li>
            <strong>Dataset JSON Generation</strong><br>
            Generate JSON files for labeling datasets in the <code>label/</code> folder. Run scripts to create structured JSON files with image paths, masks, and metadata.
          </li>
          <li>
            <strong>Generate Text Prompts Using Doubao</strong><br>
            Use Doubao to create descriptive prompts for defect data. Outputs are saved in the <code>doubao/</code> folder (supports raw text, annotated images, and cropped anomalies).
          </li>
          <li>
            <strong>Training with Anomagic_train.py</strong><br>
            Train the IP-Adapter model:
            <pre><code>python Anomagic_train.py \
    --data_json_file /path/to/your/dataset.json \
    --output_dir /path/to/output/weights</code></pre>
          </li>
          <li>
            <strong>Similarity Judgment for References</strong><br>
            Find similar images as references:
            <pre><code>python doubao/similarity_judgment_visa.py \
    --input_dir /path/to/defect_images \
    --output_json /path/to/similarity_results.json</code></pre>
          </li>
          <li>
            <strong>Generate Masks for Defects</strong><br>
            Create corresponding masks using <code>creatMask.py</code>.
          </li>
          <li>
            <strong>Anomaly Generation with Anomagic_test.py</strong><br>
            Generate synthetic anomalies:
            <pre><code>python Anomagic_test.py \
    --ip_ckpt /path/to/trained/weights/ip_adapter.bin \
    --similarity_results /path/to/similarity_results.json \
    --normal_images_dir /path/to/normal_images \
    --mask_base /path/to/generated/masks \
    --output_base /path/to/generated/anomalies</code></pre>
          </li>
        </ol>
      </div>
    </div>
  </div>
</section>


<!-- Todo List -->
<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">üõ†Ô∏è Todo List</h2>
    <div class="columns is-centered">
      <div class="column is-four-fifths content has-text-centered">
        <ul style="list-style-type: none; padding-left: 0;">
          <li>‚ùå Colab demo.</li>
          <li>‚ùå HuggingFace demo.</li>
        </ul>
      </div>
    </div>
  </div>
</section>


<!-- Acknowledgement -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">üíå Acknowledgement</h2>
    <div class="columns is-centered">
      <div class="column is-four-fifths content has-text-justified">
        <p>Our generation pipeline is based on the <a href="https://github.com/huggingface/diffusers" target="_blank">ü§óDiffusers</a> library, incorporating implementations from <a href="https://github.com/google/prompt-to-prompt/" target="_blank">Prompt-to-Prompt</a> and <a href="https://github.com/yuval-alaluf/Attend-and-Excite" target="_blank">Attend-and-Excite</a>. We also adapt implementation from <a href="https://github.com/orpatashnik/StyleCLIP" target="_blank">StyleCLIP</a> for part of our CLIP loss implementation.</p>
        <p>Big thanks to these amazing open-source works!</p>
      </div>
    </div>
  </div>
</section>


<!-- BibTeX Citation -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title is-3 has-text-centered">BibTeX</h2>
    <pre><code>@article{anomagic2025,
  title={Anomagic: Crossmodal Prompt-driven Zero-shot Anomaly Generation},
  author={Jiang, Yuxin and Luo, Wei and Zhang, Hui and Chen, Qiyu and Yao, Haiming and Shen, Weiming and Cao, Yunkang},
  journal={arXiv preprint arXiv:2501.12345},
  year={2025}
}</code></pre>
  </div>
</section>


<!-- Footer -->
<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>


<!-- Carousel Initialization Script -->
<script>
  $(document).ready(function() {
    $('#results-carousel').carousel({
      slidesPerPage: 1,
      loop: true,
      autoplay: true,
      autoplaySpeed: 5000,
      pagination: true
    });
  });
</script>

</body>
</html>
